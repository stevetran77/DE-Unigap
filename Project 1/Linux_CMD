## 1. S·∫Øp x·∫øp c√°c b·ªô phim theo ng√†y ph√°t h√†nh gi·∫£m d·∫ßn r·ªìi l∆∞u ra m·ªôt file m·ªõi

"awk 'NR>=2 && NR<=4' tmdb-movies.csv | \
awk 'BEGIN {
  FPAT = ""([^,]+)|(\""[^\""]+\"")""; OFS = "",""
}
{
  split($16, d, ""/"")
  y = d[3]; if (length(y)==2) y = (y < 30 ? ""20"" y : ""19"" y)
  m = sprintf(""%02d"", d[1])
  da = sprintf(""%02d"", d[2])
  iso_date = y ""-"" m ""-"" da
  for (i = 1; i <= NF; i++) gsub(/^""|""$/, """", $i)
  print iso_date ""|"" $0
}' | sort -r -t'|' -k1 | cut -d '|' -f2-"


## 2. L·ªçc ra c√°c b·ªô phim c√≥ ƒë√°nh gi√° trung b√¨nh tr√™n 7.5 r·ªìi l∆∞u ra m·ªôt file m·ªõi

"# 1. Ghi header v√†o file k·∫øt qu·∫£
head -n 1 tmdb-movies.csv > high_rated_movies.csv

# 2. L·ªçc d√≤ng c√≥ vote_average > 7.5 v√† n·ªëi v√†o file
tail -n +2 tmdb-movies.csv | \
awk 'BEGIN {
  FPAT = ""([^,]+)|(\""[^\""]+\"")""    # H·ªó tr·ª£ CSV ch·ª©a d·∫•u ph·∫©y trong chu·ªói
}
$18 > 7.5 { print $0 }' >> high_rated_movies.csv
"
3. T√¨m ra phim n√†o c√≥ doanh thu cao nh·∫•t v√† doanh thu th·∫•p nh·∫•t
"tail -n +2 tmdb-movies.csv | \
awk 'BEGIN {
  FPAT = ""([^,]+)|(\""[^\""]+\"")""
  max = -1; min = 1e20
}
{
  rev = $5 + 0
  if (rev > max) {
    max = rev
    max_title = $6
  }
  if (rev < min) {
    min = rev
    min_title = $6
  }
}
END {
  printf ""üé¨ Max revenue: %s ‚Üí $%.0f\n"", max_title, max
  printf ""üí∏ Min revenue: %s ‚Üí $%.0f\n"", min_title, min
}'
"


4. T√≠nh t·ªïng doanh thu t·∫•t c·∫£ c√°c b·ªô phim
"# B·ªè d√≤ng header, c·ªông d·ªìn c·ªôt 5, in t·ªïng
tail -n +2 tmdb-movies.csv | \
awk 'BEGIN {
  FPAT = ""([^,]+)|(\""[^\""]+\"")""   # CSV-safe: kh√¥ng s·ª£ d·∫•u ph·∫©y trong chu·ªói
  sum  = 0
}
{
  sum += $5                       # $5 = revenue (USD)
}
END {
  printf ""üí∞ T·ªïng doanh thu t·∫•t c·∫£ phim: $%.0f\n"", sum
}'
"


5. Top 10 b·ªô phim ƒëem v·ªÅ l·ª£i nhu·∫≠n cao nh·∫•t
"############ 1) Th√™m d√≤ng header v√†o file k·∫øt qu·∫£ ############
head -n 1 tmdb-movies.csv > top10_profit.csv

############ 2) T√≠nh profit, sort gi·∫£m d·∫ßn, l·∫•y top 10 ########
tail -n +2 tmdb-movies.csv | \
awk 'BEGIN {
  FPAT = ""([^,]+)|(\""[^\""]+\"")""          # CSV-safe
}
{
  profit = $5 - $4                       # revenue ‚Äì budget
  print profit ""|"" $0                    # th√™m c·ªôt profit t·∫°m
}' | \
sort -t'|' -k1,1nr |                     # sort theo profit gi·∫£m d·∫ßn
head -n 10 | \
cut -d'|' -f2- >> top10_profit.csv       # b·ªè c·ªôt profit t·∫°m, ghi k·∫øt qu·∫£
"



6. ƒê·∫°o di·ªÖn n√†o c√≥ nhi·ªÅu b·ªô phim nh·∫•t v√† di·ªÖn vi√™n n√†o ƒë√≥ng nhi·ªÅu phim nh·∫•t
"tail -n +2 tmdb-movies.csv | \
awk 'BEGIN { FPAT = ""([^,]+)|(\""[^\""]+\"")"" } { print $9 }' | \
sort | uniq -c | sort -nr | head -n 10
"
